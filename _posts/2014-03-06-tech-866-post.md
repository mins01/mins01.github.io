---
title: "전자정부 프레임워크에서 MyBatis 사용"
date: 2014-03-06 16:08:16 +0900
categories: [java]
---

[설명잘된곳](http://mybatis.github.io/mybatis-3/ko/sqlmap-xml.html "설명잘된곳")  
- - - - - -

pom.xml  
&lt;!--  MyBatis --&gt;  
&lt;dependency&gt;  
    &lt;groupId&gt;org.mybatis&lt;/groupId&gt;  
    &lt;artifactId&gt;mybatis&lt;/artifactId&gt;  
    &lt;version&gt;3.2.2&lt;/version&gt;  
&lt;/dependency&gt;  
- - - - - -

설정파일  
- - - - - -

context-mapper.xml // spring 쪽에서 읽어가도록 되어있어야함.  
  
&lt;?xml version="1.0" encoding="UTF-8"?&gt;  
&lt;beans xmlns="http://www.springframework.org/schema/beans"  
xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  
xmlns:aop="http://www.springframework.org/schema/aop"  
xmlns:tx="http://www.springframework.org/schema/tx"  
xmlns:util="http://www.springframework.org/schema/util"  
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd  
http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd   
http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd  
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd"&gt;  
  
&lt;!-- SqlSession setup for MyBatis Database Layer --&gt;  
&lt;bean id="sqlSession" class="org.mybatis.spring.SqlSessionFactoryBean"&gt;  
&lt;property name="dataSource" ref="dataSource" /&gt;  
&lt;property name="configLocation" value="classpath:/egovframework/sqlmap/mybatis/sql-mapper-config.xml" /&gt;  
&lt;property name="mapperLocations" value="classpath:/egovframework/sqlmap/mybatis/mappers/*.xml" /&gt;  
&lt;/bean&gt;  
  
&lt;!-- MapperConfigurer setup for MyBatis Database Layer with @Mapper("deptMapper") in DeptMapper Interface --&gt;  
&lt;!-- @Mapper 어노케이션을 읽어오도록 한다.(그냥 다른거 써도 될것 같은데-&gt;안되더라.) --&gt;  
 &lt;bean class="egovframework.rte.psl.dataaccess.mapper.MapperConfigurer"&gt;  
&lt;property name="basePackage" value="temp" /&gt;  
&lt;/bean&gt;  
  
&lt;/beans&gt;- - - - - -

sql-mapper-config.xml  
  
&amp;lt;?xml version="1.0" encoding="UTF-8"?&amp;gt;  
&amp;lt;!DOCTYPE configuration PUBLIC "-//mybatis.org//DTD Config 3.0//EN" "http://mybatis.org/dtd/mybatis-3-config.dtd"&amp;gt;  
  
&amp;lt;configuration&amp;gt;  
    &amp;lt;!-- mapper에서 사용할 패키지까지 표현한 클래스의 별칭, 단순한 별칭이다. 없을 경우 풀패스로 표현 --&amp;gt;  
    &amp;lt;typeAliases&amp;gt;  
    &lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;typeAlias alias="TempVO" type="temp.example.TempVO" /&amp;gt;  
    &lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;  
    &amp;lt;/typeAliases&amp;gt;  
      
&amp;lt;!-- JAVA파일에서 지정할 것이라서 여기서 지정 안함.  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;mappers&amp;gt;  
        &amp;lt;mapper resource="META-INF/sqlmap/mappers/mysql/department_mysql.xml" /&amp;gt;  
        &amp;lt;mapper resource="META-INF/sqlmap/mappers/mysql/employee_mysql.xml" /&amp;gt;  
   &amp;lt;/mappers&amp;gt;   
 --&amp;gt;  
   
&amp;lt;/configuration&amp;gt;- - - - - -

mapper_SQL_mysql.xml  
  
  
&amp;lt;?xml version="1.0" encoding="UTF-8"?&amp;gt;  
&amp;lt;!DOCTYPE mapper   PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&amp;gt;  
  
&amp;lt;mapper namespace="temp.ex.mybatis.ExMapper"&amp;gt;  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;select id="selectList" parameterType="TempVO" resultType="TempVO"&amp;gt;  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;![CDATA[  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;SELECT  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;USER_NAME,USER_NUMBER  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;FROM tbl_testp01   
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;WHERE 1=1  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;]]&amp;gt;  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;if test="user_name != null and user_name != ''"&amp;gt;  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt; &lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;AND USER_NAME=#{user_name}  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;/if&amp;gt;  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;if test="user_number != null  and user_number != ''"&amp;gt;  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt; &lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;AND USER_NUMBER=#{user_number}  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt; &amp;lt;/if&amp;gt;&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;   
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;/select&amp;gt;  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;insert id="insert_tbl_testp01"&amp;gt;  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;INSERT INTO tbl_testp01   
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;( user_name  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;  , user_number )  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;VALUES ( #{user_name}  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;  , #{user_number}  )  
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&amp;lt;/insert&amp;gt;  
&amp;lt;/mapper&amp;gt;  
&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;- - - - - -&amp;#xD;
&amp;#xD;
&lt;/div&gt;&lt;div&gt;JAVA파일&lt;/div&gt;&lt;div&gt;- @Controller  &amp;#xD;
public class ExController&amp;#xD;
- @Service("exService")  &amp;#xD;
public class ExServiceImpl&amp;#xD;
- @Mapper("exMapper")  &amp;#xD;
public interface ExMapper&amp;#xD;
// mapper_SQL_mysql에서 namespace로 지정된 인터페이스, ExServiceImpl 에서 (List&amp;amp;lt;TempVO&amp;amp;gt;) exMapper.selectList(vo); 처럼 바로 호출할 수 있다.&amp;#xD;
&amp;#xD;
&amp;#xD;
&amp;lt;div&amp;gt;DAO를 없이 사용했다. Mapper로 설정되면 자동으로 DAO로 만들어버리는 듯... 어떻게 그래되는지는 모르겠지만.&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;- - - - - -&amp;amp;#xD;
&amp;amp;#xD;
쿼리를 어노테이션으로 할 경우&amp;lt;/div&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;div&amp;gt;  &amp;amp;#xD;
&amp;lt;/div&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;div&amp;gt;import java.util.List;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;  &amp;amp;#xD;
&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;import org.apache.ibatis.annotations.Insert;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;import org.apache.ibatis.annotations.Select;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;  &amp;amp;#xD;
&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;import egovframework.rte.psl.dataaccess.mapper.Mapper;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;  &amp;amp;#xD;
&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;import temp.example.TempVO;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;  &amp;amp;#xD;
&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;@Mapper("exMapperByAnnotation")&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;public interface ExMapperByAnnotation {&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;/**&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt; * 글을 조회한다.&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt; * @param vo - 조회할 정보가 담긴 SampleVO&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt; * @return 조회한 글&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt; * @exception Exception&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt; */&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;@Select("SELECT USER_NAME,USER_NUMBER FROM tbl_testp01 WHERE 1=1 AND USER_NAME=#{user_name} AND USER_NUMBER=#{user_number}")&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;List&amp;amp;amp;lt;TempVO&amp;amp;amp;gt; selectListByAnnotation(TempVO vo) throws Exception;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;@Insert("INSERT INTO tbl_testp01 ( user_name , user_number ) VALUES ( #{user_name} , #{user_number}  )")&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;void insert_tbl_testp01ByAnnotation(TempVO vo) throws Exception;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;&amp;lt;/div&amp;gt;&amp;lt;div&amp;gt;}&amp;lt;/div&amp;gt;&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;mapper를 위처럼 한다.&lt;/div&gt;&lt;div&gt;interface라서 if 등을 처리할 수 없어서 난감하네.&lt;/div&gt;&lt;div&gt;동적 쿼리가 지원안된다.  &amp;#xD;
${XXXX}를 쓸 수 있는지 테스트 해봐야겠네.&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;


[🔗link](http://www.mins01.com/mh/tech/read/866)