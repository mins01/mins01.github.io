---
title: "전자정부 프레임워크에서 MyBatis 사용"
date: 2014-03-06 16:08:16 +0900
categories: [java]
---

[설명잘된곳](http://mybatis.github.io/mybatis-3/ko/sqlmap-xml.html "설명잘된곳")  
- - - - - -

pom.xml  
  
<dependency>  
    <groupid>org.mybatis</groupid>  
    <artifactid>mybatis</artifactid>  
    <version>3.2.2</version>  
</dependency>  
- - - - - -

설정파일  
- - - - - -

context-mapper.xml // spring 쪽에서 읽어가도록 되어있어야함.  
  
<?xml version="1.0" encoding="UTF-8"??>
  
<beans xmlns="http://www.springframework.org/schema/beans"></beans>xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"  
xmlns:aop="http://www.springframework.org/schema/aop"  
xmlns:tx="http://www.springframework.org/schema/tx"  
xmlns:util="http://www.springframework.org/schema/util"  
xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd  
http://www.springframework.org/schema/tx http://www.springframework.org/schema/tx/spring-tx-3.0.xsd   
http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util-3.0.xsd  
http://www.springframework.org/schema/aop http://www.springframework.org/schema/aop/spring-aop-3.0.xsd">  
  
  
<bean class="org.mybatis.spring.SqlSessionFactoryBean" id="sqlSession">  
<property name="dataSource" ref="dataSource"></property>  
<property name="configLocation" value="classpath:/egovframework/sqlmap/mybatis/sql-mapper-config.xml"></property>  
<property name="mapperLocations" value="classpath:/egovframework/sqlmap/mybatis/mappers/*.xml"></property>  
</bean>  
  
  
  
 <bean class="egovframework.rte.psl.dataaccess.mapper.MapperConfigurer">  
<property name="basePackage" value="temp"></property>  
</bean>  
  
- - - - - -

sql-mapper-config.xml  
  
<?xml version="1.0" encoding="UTF-8"??>
  
  
  
<configuration>  &#xD;
      &#xD;
    &lt;typealiases&gt;  &amp;#xD;
    &amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;typealias alias="TempVO" type="temp.example.TempVO"&amp;gt;&amp;lt;/typealias&amp;gt;  &amp;#xD;
    &amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;  &amp;#xD;
    &lt;/typealiases&gt;  &#xD;
      &#xD;
  &#xD;
   &#xD;
</configuration>- - - - - -

mapper_SQL_mysql.xml  
  
  
<?xml version="1.0" encoding="UTF-8"??>
  
nbsp; PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd"&gt;  
  
<mapper namespace="temp.ex.mybatis.ExMapper">  &#xD;
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&lt;select id="selectList" parametertype="TempVO" resulttype="TempVO"&gt;  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;SELECT  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;USER_NAME,USER_NUMBER  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;FROM tbl_testp01   &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;WHERE 1=1  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;]]&amp;amp;gt;  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;if test="user_name != null and user_name != ''"&amp;gt;  &amp;amp;#xD;
&amp;amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt; &amp;amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;AND USER_NAME=#{user_name}  &amp;amp;#xD;
&amp;amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;&amp;lt;/if&amp;gt;  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;if test="user_number != null  and user_number != ''"&amp;gt;  &amp;amp;#xD;
&amp;amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt; &amp;amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;AND USER_NUMBER=#{user_number}  &amp;amp;#xD;
&amp;amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt; &amp;lt;/if&amp;gt;&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;   &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;&lt;/select&gt;  &#xD;
&lt;span class="Apple-tab-span" style="white-space: pre;"&gt;&lt;/span&gt;&lt;insert id="insert_tbl_testp01"&gt;  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;INSERT INTO tbl_testp01   &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;( user_name  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;  , user_number )  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;VALUES ( #{user_name}  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;  , #{user_number}  )  &amp;#xD;
&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;&lt;/insert&gt;  &#xD;
</mapper>  
  &#xD;
- - - - - -&#xD;
&#xD;
JAVA파일- @Controller  &#xD;
public class ExController&#xD;
- @Service("exService")  &#xD;
public class ExServiceImpl&#xD;
- @Mapper("exMapper")  &#xD;
public interface ExMapper&#xD;
// mapper_SQL_mysql에서 namespace로 지정된 인터페이스, ExServiceImpl 에서 (List&lt;tempvo&gt;) exMapper.selectList(vo); 처럼 바로 호출할 수 있다.&lt;/tempvo&gt;&#xD;
&#xD;
&#xD;
&lt;div&gt;DAO를 없이 사용했다. Mapper로 설정되면 자동으로 DAO로 만들어버리는 듯... 어떻게 그래되는지는 모르겠지만.&lt;/div&gt;&lt;div&gt;- - - - - -&amp;#xD;
&amp;#xD;
쿼리를 어노테이션으로 할 경우&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;import java.util.List;&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;import org.apache.ibatis.annotations.Insert;&lt;/div&gt;&lt;div&gt;import org.apache.ibatis.annotations.Select;&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;import egovframework.rte.psl.dataaccess.mapper.Mapper;&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;import temp.example.TempVO;&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;@Mapper("exMapperByAnnotation")&lt;/div&gt;&lt;div&gt;public interface ExMapperByAnnotation {&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;/**&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt; * 글을 조회한다.&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt; * @param vo - 조회할 정보가 담긴 SampleVO&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt; * @return 조회한 글&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt; * @exception Exception&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt; */&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;@Select("SELECT USER_NAME,USER_NUMBER FROM tbl_testp01 WHERE 1=1 AND USER_NAME=#{user_name} AND USER_NUMBER=#{user_number}")&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;List&amp;lt;tempvo&amp;gt; selectListByAnnotation(TempVO vo) throws Exception;&amp;lt;/tempvo&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;@Insert("INSERT INTO tbl_testp01 ( user_name , user_number ) VALUES ( #{user_name} , #{user_number}  )")&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;void insert_tbl_testp01ByAnnotation(TempVO vo) throws Exception;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;&lt;/div&gt;&lt;div&gt;}&lt;/div&gt;  &#xD;
mapper를 위처럼 한다.interface라서 if 등을 처리할 수 없어서 난감하네.동적 쿼리가 지원안된다.  &#xD;
${XXXX}를 쓸 수 있는지 테스트 해봐야겠네.  &#xD;
  &#xD;



[🔗link](http://www.mins01.com/mh/tech/read/866)