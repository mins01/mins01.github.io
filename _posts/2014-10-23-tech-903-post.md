---
title: "ì›¹ ì¬ìš”ì²­ ë°©ì§€ ë° íŠ¸ë˜í”½ ê°ì†Œë¥¼ ìœ„í•œ ë°©ë²•"
date: 2014-10-23 13:29:12 +0900
categories: [weblang]
---

- from cache
- ì„œë²„ì— ìš”ì²­ìì²´ë¥¼ í•˜ì§€ ì•ŠëŠ”ë‹¤.
- ê°€ì¥ íš¨ê³¼ê°€ ì¢‹ë‹¤.(ìš”ì²­ ìì²´ê°€ ì—†ìœ¼ë¯€ë¡œ)

- ìµœì´ˆ í•œë²ˆ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¤ë©´, ê·¸ í›„ë¡œëŠ” ì›¹ ë¸Œë¼ìš°ì €ì˜ ìºì‹œì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ë‹¤.  
ì¦‰, ì„œë²„ì™€ì˜ í†µì‹ ì´ ì—†ì–´ì§„ë‹¤.
- í•˜ì§€ë§Œ F5ë¥¼ ëˆ„ë¥¼ ê²½ìš° ìƒˆë¡œ ë°ì´í„°ê°€ ì „ì†¡ëœë‹¤.(HTTP Code 200 ë°œìƒ)
- ê´€ë ¨ ì‘ë‹µ í•´ë” ë° PHP ì ìš©ë²• ($gëŠ” ìºì‹œ ê¸°ê°„(ì´ˆ))
- header('Cache-Control:public, max-age='.$g); // HTTP/1.1
- ì§€ì • ì´ˆ ì´ì „ê¹Œì§€ëŠ” ì¬ìš”ì²­í•˜ì§€ ì•Šë„ë¡ ê¶Œì¥í•¨ (ìƒˆë¡œ ê³ ì¹¨ì—ì„œëŠ” ë¬´ì‹œë¨)

- header("Expires: ".gmdate("D, d M Y H:i:s", time()+$g)." GMT");//ìºì‹œ
- ì§€ì • ì‹œê°„ê¹Œì§€ëŠ” ì¬ìš”ì²­ í•˜ì§€ ì•Šë„ë¡ ê¶Œì¥í•¨Â (ìƒˆë¡œ ê³ ì¹¨ì—ì„œëŠ” ë¬´ì‹œë¨)

- apacheì˜ ê²½ìš°Â [mod_expires ì ìš©](http://httpd.apache.org/docs/current/mod/mod_expires.html "mod_expires")


- 304 Not Modified
- ìš”ì²­ì€ í•˜ì§€ë§Œ, íŠ¸ë˜í”½ì´ ì•„ì£¼ ì ê²Œ ë°œìƒëœë‹¤.(í•´ë” ì „ì†¡ ì •ë„ë§Œ ë°œìƒ)
- F5ë¡œ ìƒˆë¡œ ìš”ì²­í•´ë„ Etagë‚˜Â Last-Modifiedì˜ ì¡°ê±´ì— ë§ìœ¼ë©´ HTTP CodeëŠ” 304ê°€ ë°œìƒëœë‹¤.(ì‹¤ì œ ë°ì´í„° ì „ì†¡ì€ ì—†ìŒ)  
(ctrl+F5ì˜ ê²½ìš° etagì™€Â Last-Modified ê°€ ì—†ì´ ìš”ì²­ë˜ë¯€ë¡œ ìƒˆë¡œ ê°€ì ¸ì˜¨ë‹¤.)
- ê´€ë ¨ ì‘ë‹µ í•´ë” ë° PHPì ìš©ë²•
- header("Etag: ".$etag_key);//etag
- íŒŒì¼ì˜ ìˆ˜ì •ë‚´ì—­ì„ Etagë¡œ ë§Œë“¤ì–´ì„œ ì¶œë ¥í•œë‹¤.  
í´ë¼ì´ì–¸íŠ¸ê°€ ê°™ì€ Etagë¡œ ìš”ì²­í•˜ë©´, 304ì½”ë“œë¥¼ ì•Œë ¤ì¤€ë‹¤.
- ì•„íŒŒì¹˜ì˜ ê²½ìš° [FileETag](http://httpd.apache.org/docs/2.2/mod/core.html#fileetag "FileETag") ë¶€ë¶„ ì°¸ê³ 
- íŒŒì¼ ìˆ˜ì • ì‹œê°„ì„ ì‚¬ìš©í•  ê²½ìš° ë¬¸ì œê°€ ë  ìˆ˜ ìˆë‹¤.  
ì„œë²„ë¥¼ ì—¬ëŸ¬ëŒ€ ì‚¬ìš©í•  ê²½ìš° ì„œë²„ ê°„ì˜ íŒŒì¼ì˜ ì‹œê°„ ì°¨ê°€ ë°œìƒë  ìˆ˜ ìˆê¸° ë•Œë¬¸ì´ë‹¤.
- ì—¬ëŸ¬ì„œë²„ë¥¼ ë¬¶ì–´ì“°ëŠ”(L4ì— ì—°ê²° í•´ì„œ) ê²½ìš° ì‚¬ìš©ì•ˆí•˜ëŠ”ê²Œ ì¢‹ë‹¤
- PHPì—ì„œ ì²˜ë¦¬í•  ê²½ìš° ìš”ì²­ì—ì„œ HTTP_IF_NONE_MATCH ê´€ë ¨ ì²˜ë¦¬ê°€ í•„ìš”

- header('Last-Modified: '.gmdate("D, d M Y H:i:s", time()+$g)." GMT");
- ì§€ì • ì‹œê°„ê¹Œì§€ëŠ” íŒŒì¼ì´ ìˆ˜ì •ë˜ì§€ ì•ŠëŠ”ë‹¤ëŠ” ê²ƒì„ ë‚˜íƒ€ë‚¸ë‹¤.  
ì¦‰, ê·¸ ì‹œê°„ì— ì¬ìš”ì²­í•´ë´¤ì 304 ì½”ë“œê°€ ë°˜í™˜ëœë‹¤.
- apacheì˜ ê²½ìš°Â [mod_expires ì ìš©](http://httpd.apache.org/docs/current/mod/mod_expires.html "mod_expires")
- PHPì—ì„œ ì²˜ë¦¬í•  ê²½ìš° ìš”ì²­ì—ì„œÂ HTTP_IF_MODIFIED_SINCEÂ ê´€ë ¨ ì²˜ë¦¬ê°€ í•„ìš”




  
# ì°¸ê³ - [ì•„íŒŒì¹˜ ìºì‹œ ê°€ì´ë“œ](http://httpd.apache.org/docs/2.2/caching.html "ì•„íŒŒì¹˜ ìºì‹œ ê°€ì´ë“œ")

# ë¸Œë¼ìš°ì € ë™ì‘ì— ë”°ë¥¸ ë™ì‘ ì„¤ëª… (í¬ë¡¬ì—ì„œ í…ŒìŠ¤íŠ¸í•˜ì˜€ìŒ)  
- ë¸Œë¼ìš°ì € ë§í¬ë¡œ í˜ì´ì§€ ì´ë™
- Cache-Control, Expires ì ìš©ë¨ (from cache ë°œìƒ í•  ìˆ˜ ìˆìŒ)
- Etag,Â Last-Modified ë¥¼ ì ìš©í•´ì„œ ì¬ ìš”ì²­ë¨.(ì¦‰, 304 ë°œìƒ í•  ìˆ˜ ìˆìŒ)

- ë¸Œë¼ìš°ì €ì—ì„œ F5ë¥¼ ëˆ„ë¥¼ ê²½ìš°
- Cache-Control, Expires ë¬´ì‹œë¨ (ìƒˆë¡œ ë°›ìŒ)
- Etag,Â Last-Modified ë¥¼ ì ìš©í•´ì„œ ì¬ ìš”ì²­ë¨.(ì¦‰, 304 ë°œìƒ í•  ìˆ˜ ìˆìŒ)

- ë¸Œë¼ìš°ì €ì—ì„œ ctrl+F5ë¥¼ ëˆ„ë¥¼ ê²½ìš°
- Cache-Control, Expires ë¬´ì‹œë¨ (ìƒˆë¡œ ë°›ìŒ)
- Etag,Â Last-Modified ë¥¼ ë¬´ì‹œí•˜ë©´ì„œ ì¬ ìš”ì²­ë¨.(ì™„ë²½í•œ ìƒˆë¡œ ê³ ì¹¨)


- - - - - -

# PHPì—ì„œ Etag ìƒì„¸&lt;span class="Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;$etag_key = 'AAAAA' //ETAG ì•Œì•„ì„œ ë§Œë“¤ì–´ë¼...ë³´í†µ íŒŒì¼í¬ê¸°, íŒŒì¼ ìˆ˜ì •ì¼ì„ ì‚¬ìš©í•´ì„œ ë§Œë“ ë‹¤.  
&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;if(isset($_SERVER['HTTP_IF_NONE_MATCH'][0]) &amp;amp;amp;&amp;amp;amp; trim($_SERVER['HTTP_IF_NONE_MATCH'])==$etag_key){&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;header("HTTP/1.1 304 Not Modified",true,304);Â &lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;exit();&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;}else{&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;header("Etag: ".$etag_key);&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;//etag&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;}&lt;/div&gt;- - - - - -

# PHPì—ì„œ Last-Modified ìƒì„¸$gëŠ” ì²˜ë¦¬í•˜ê³ í”ˆ ê¸°ê°„(ì´ˆ)  
&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;if(isset($_SERVER['HTTP_IF_MODIFIED_SINCE'][0]) &amp;amp;amp;&amp;amp;amp; Â strtotime($_SERVER['HTTP_IF_MODIFIED_SINCE']) &amp;amp;lt; time()){&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;header("HTTP/1.1 304 Not Modified",true,304);Â &lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;exit();&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;}else{&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;header('Last-Modified: '.gmdate("D, d M Y H:i:s", time()+$g)." GMT");&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;}&lt;/div&gt;  
  



[ğŸ”—link](http://www.mins01.com/mh/tech/read/903)