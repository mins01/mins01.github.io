---
title: "페이시북 인사이트 게시물 통계 합치기 php"
date: 2017-10-27 15:07:17 +0900
categories: [php]
---

<?php 
  &#xD;
error_reporting(E_ALL);set_time_limit(0);  &#xD;
date_default_timezone_set('Europe/London');  &#xD;
/** Include path **/set_include_path('PHPExcel/Classes/');  &#xD;
/** PHPExcel_IOFactory */include 'PHPExcel/IOFactory.php';  &#xD;
  &#xD;
$inputFileType = 'Excel2007';$inputFileName = 'page_201710_201712.xlsx';  &#xD;
/**  Create a new Reader of the type defined in $inputFileType  **/$objReader = PHPExcel_IOFactory::createReader($inputFileType);/**  Load $inputFileName to a PHPExcel Object  **/$objPHPExcel = $objReader-&amp;gt;load($inputFileName);  &#xD;
  &#xD;
  &#xD;
echo '- - - - - -&#xD;
&#xD;
';  &#xD;
echo 'Reading the number of Worksheets in the WorkBook  &#xD;
';/**  Use the PHPExcel object's getSheetCount() method to get a count of the number of WorkSheets in the WorkBook  */$sheetCount = $objPHPExcel-&amp;gt;getSheetCount();echo 'There ',(($sheetCount == 1) ? 'is' : 'are'),' ',$sheetCount,' WorkSheet',(($sheetCount == 1) ? '' : 's'),' in the WorkBook  &#xD;
  &#xD;
';  &#xD;
echo 'Reading the names of Worksheets in the WorkBook  &#xD;
';  &#xD;
$rowss = array();/**  Use the PHPExcel object's getSheetNames() method to get an array listing the names/titles of the WorkSheets in the WorkBook  */$sheetNames = $objPHPExcel-&amp;gt;getSheetNames();  &#xD;
foreach($sheetNames as $sheetIndex =&amp;gt; $sheetName) {&lt;span style="white-space:pre"&gt;&lt;/span&gt;echo $sheetIndex,'=',$sheetName,"\n";&lt;span style="white-space:pre"&gt;&lt;/span&gt;$sheet = $objPHPExcel-&amp;gt;getSheet($sheetIndex); &lt;span style="white-space:pre"&gt;&lt;/span&gt;$maxRow = $sheet-&amp;gt;getHighestRow();          // 마지막 라인&lt;span style="white-space:pre"&gt;&lt;/span&gt;$maxColumn = $sheet-&amp;gt;getHighestColumn();    // 마지막 칼럼&lt;span style="white-space:pre"&gt;&lt;/span&gt;$target = "A"."1".":"."$maxColumn"."$maxRow";&lt;span style="white-space:pre"&gt;&lt;/span&gt;$rows = $sheet-&amp;gt;rangeToArray($target, NULL, TRUE, FALSE);&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;// if($sheetIndex=0){&lt;span style="white-space:pre"&gt;&lt;/span&gt;// &lt;span style="white-space:pre"&gt;&lt;/span&gt;array_shift($rows);&lt;span style="white-space:pre"&gt;&lt;/span&gt;// }else{&lt;span style="white-space:pre"&gt;&lt;/span&gt;// &lt;span style="white-space:pre"&gt;&lt;/span&gt;foreach($rows as $k=&amp;gt;$v){&lt;span style="white-space:pre"&gt;&lt;/span&gt;// &lt;span style="white-space:pre"&gt;&lt;/span&gt;$rowss[$sheetIndex][$k]&lt;span style="white-space:pre"&gt;&lt;/span&gt;// &lt;span style="white-space:pre"&gt;&lt;/span&gt;}&lt;span style="white-space:pre"&gt;&lt;/span&gt;// }&lt;span style="white-space:pre"&gt;&lt;/span&gt;$rowss[$sheetIndex]  = $rows;}// print_r($rowss[0]);// print_r($rowss);// exit;//=============$inputFileNames = array(// 'page_201710_201712.xlsx','page_201707_201709.xlsx','page_201704_201706.xlsx','page_201701_201703.xlsx','page_201610_201612.xlsx','page_201607_201609.xlsx','page_201604_201606.xlsx','page_201601_201603.xlsx','page_201510_201512.xlsx',);$inputFileType = 'Excel2007';  &#xD;
foreach ($inputFileNames as $inputFileName) {&lt;span style="white-space:pre"&gt;&lt;/span&gt;// $inputFileName = 'page_201707_201709.xlsx';&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;/**  Create a new Reader of the type defined in $inputFileType  **/&lt;span style="white-space:pre"&gt;&lt;/span&gt;$objReader2 = PHPExcel_IOFactory::createReader($inputFileType);&lt;span style="white-space:pre"&gt;&lt;/span&gt;/**  Load $inputFileName to a PHPExcel Object  **/&lt;span style="white-space:pre"&gt;&lt;/span&gt;$objPHPExcel2 = $objReader-&amp;gt;load($inputFileName);&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;$sheetNames = $objPHPExcel2-&amp;gt;getSheetNames();&lt;span style="white-space:pre"&gt;&lt;/span&gt;foreach($sheetNames as $sheetIndex =&amp;gt; $sheetName) {&lt;span style="white-space:pre"&gt;&lt;/span&gt;echo $sheetIndex,'=',$sheetName,"\n";&lt;span style="white-space:pre"&gt;&lt;/span&gt;$sheet = $objPHPExcel2-&amp;gt;getSheet($sheetIndex); &lt;span style="white-space:pre"&gt;&lt;/span&gt;$maxRow = $sheet-&amp;gt;getHighestRow();          // 마지막 라인&lt;span style="white-space:pre"&gt;&lt;/span&gt;$maxColumn = $sheet-&amp;gt;getHighestColumn();    // 마지막 칼럼&lt;span style="white-space:pre"&gt;&lt;/span&gt;if($sheetIndex==0){&lt;span style="white-space:pre"&gt;&lt;/span&gt;$target = "A"."3".":"."$maxColumn"."$maxRow";&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;$rows = $sheet-&amp;gt;rangeToArray($target, NULL, TRUE, FALSE);&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;}else{&lt;span style="white-space:pre"&gt;&lt;/span&gt;$target = "A"."2".":"."$maxColumn"."$maxRow";&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;$rows = $sheet-&amp;gt;rangeToArray($target, NULL, TRUE, FALSE);&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;}&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;// var_dump($rowss[$sheetIndex]);&lt;span style="white-space:pre"&gt;&lt;/span&gt;$rowss[$sheetIndex] = array_merge($rowss[$sheetIndex],$rows);&lt;span style="white-space:pre"&gt;&lt;/span&gt;}}  &#xD;
$sheetNames = $objPHPExcel-&amp;gt;getSheetNames();  &#xD;
foreach($sheetNames as $sheetIndex =&amp;gt; $sheetName) {&lt;span style="white-space:pre"&gt;&lt;/span&gt;echo $sheetIndex,'=',$sheetName,"\n";&lt;span style="white-space:pre"&gt;&lt;/span&gt;$sheet = $objPHPExcel-&amp;gt;getSheet($sheetIndex); &lt;span style="white-space:pre"&gt;&lt;/span&gt;$maxRow = $sheet-&amp;gt;getHighestRow();          // 마지막 라인&lt;span style="white-space:pre"&gt;&lt;/span&gt;$maxColumn = $sheet-&amp;gt;getHighestColumn();    // 마지막 칼럼&lt;span style="white-space:pre"&gt;&lt;/span&gt;$target = "A"."1".":"."$maxColumn"."$maxRow";&lt;span style="white-space:pre"&gt;&lt;/span&gt;// $rowss[$sheetIndex] = $sheet-&amp;gt;rangeToArray($target, NULL, TRUE, FALSE);&lt;span style="white-space:pre"&gt;&lt;/span&gt;&lt;span style="white-space:pre"&gt;&lt;/span&gt;$sheet-&amp;gt;fromArray($rowss[$sheetIndex], '', 'A1');}$objWriter = PHPExcel_IOFactory::createWriter($objPHPExcel, 'Excel2007');$objWriter-&amp;gt;save('result.xlsx');  &#xD;
?&amp;gt;


[🔗link](http://www.mins01.com/mh/tech/read/1120)