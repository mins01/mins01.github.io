---
title: "ë¼ë¼ë²¨, laravel ë¡œ ìƒ˜í”Œ ë§Œë“¤ì–´ ë³´ì. (4)(end) view , controller"
date: 2019-01-11 11:16:58 +0900
categories: 
---
  

### controller ìˆ˜ì •

app\Http\Controllers\SimpleCommentController.php
  
    <?php
    <br></br>
    namespace App\Http\Controllers;
    <br></br>
    use App\SimpleComment;
    use Illuminate\Http\Request;
    <br></br>
    class SimpleCommentController extends Controller
    {
    Â  /**
    Â  * Display a listing of the resource.
    Â  *
    Â  * @return \Illuminate\Http\Response
    Â  */
    Â  public function index()
    Â  {
    Â  Â  return [
    Â  Â  Â  'result'=>true,
    Â  Â  Â  'count' => SimpleComment::count(),
    Â  Â  Â  'simpleComments' => SimpleComment::lists(),
    Â  Â  ];
    Â  Â  // return View('sc/index');
    Â  Â  //
    Â  }
    Â Â 
    Â  /**
    Â  * Store a newly created resource in storage.
    Â  *
    Â  * @paramÂ  \Illuminate\Http\RequestÂ  $request
    Â  * @return \Illuminate\Http\Response
    Â  */
    Â  public function store(Request $request)
    Â  {
    Â  Â  //
    Â  }
    Â Â 
    Â  /**
    Â  * Display the specified resource.
    Â  *
    Â  * @paramÂ  \App\SimpleCommentÂ  $simpleComment
    Â  * @return \Illuminate\Http\Response
    Â  */
    Â  public function show(SimpleComment $simpleComment)
    Â  {
    Â  Â  //
    Â  }
    Â Â 
    Â  /**
    Â  * Update the specified resource in storage.
    Â  *
    Â  * @paramÂ  \Illuminate\Http\RequestÂ  $request
    Â  * @paramÂ  \App\SimpleCommentÂ  $simpleComment
    Â  * @return \Illuminate\Http\Response
    Â  */
    Â  public function update(Request $request, SimpleComment $simpleComment)
    Â  {
    Â  Â  if(!$simpleComment->checkScPass($request->input('sc_pass'))){
    Â  Â  Â  return [
    Â  Â  Â  Â  'result'=>false,
    Â  Â  Â  Â  'message'=>'Incorrect password',
    Â  Â  Â  ];
    Â  Â  }
    Â  Â  $simpleComment->update($request->all());
    Â  Â  return $this->index();
    }
    Â Â 
    Â  /**
    Â  * Remove the specified resource from storage.
    Â  *
    Â  * @paramÂ  \App\SimpleCommentÂ  $simpleComment
    Â  * @return \Illuminate\Http\Response
    Â  */
    Â  //Â $request ë¥¼ ì¶”ê°€, ì œì–´ ì—­ì „ìœ¼ë¡œ ì•Œì•„ì„œ ë°ì´í„°ë¥¼ ì „ë‹¬ í•´ ì¤€ë‹¤.
    Â  public function destroy(Request $request, SimpleComment $simpleComment)
    Â  {
    Â  Â  if(!$simpleComment->checkScPass($request->input('sc_pass'))){
    Â  Â  Â  return [
    Â  Â  Â  Â  'result'=>false,
    Â  Â  Â  Â  'message'=>'Incorrect password',
    Â  Â  Â  ];
    Â  Â  }
    Â  Â  $simpleComment->delete();
    Â  Â  return $this->index();
    Â  }
    
    }

### APIìª½ route ìˆ˜ì • (ê²½ë¡œê°€ ëª¨ë¸ëª…ì— ì•ˆ ë§ìœ¼ë©´ ì»¨íŠ¸ë¡¤ëŸ¬ì—ì„œ ëª¨ë¸ì„ ì œëŒ€ë¡œ ëª» ê°€ì ¸ì˜®)

routes\api.php
  
    <strike>Route::resource('sc', 'SimpleCommentController');</strike>
    Route::resource('simpleComment', 'SimpleCommentController');

### web ìª½ route ì¶”ê°€

routes\web.php
`Route::any('/sc','WebSimpleCommentController@index');`  
### web ìª½ controller ì¶”ê°€

    app\Http\Controllers\WebSimpleCommentController.php
    <?php
    <br></br>
    namespace App\Http\Controllers;
    <br></br>
    use Illuminate\Http\Request;
    <br></br>
    class WebSimpleCommentController extends Controller
    {
    	protected $title='SimpleComment';
    Â  Â  public function index($value='')
    Â  Â  {
    Â  Â  	return View('sc.lists',['title'=>$this->title]);
    Â  Â  }
    }
    

### web ìª½ view íŒŒì¼

resources\views\sc\lists.blade.php

    <code style="font-size: 12.6px;">@extends('sc.master')
    <br></br>
    @section('title', $title)
    <br></br>
    @section('content')
    	<h1>SimpleComment</h1>
    	<div id="sc_app">
    		<ul class="list-group"Â  v-for="sc in res.simpleComments">
    			<li class="list-group-item">
    				<form onsubmit="ajax_action.action(this);return false;" action="{{ route('simpleComment.update',':sc_id') }}">
    					{{ csrf_field() }}
    					<input type="text" name="_method" disabled value="" />
    					<input type="text" name="sc_id" readonly v-model="sc.sc_id" />
    					<input type="password" name="sc_pass"/>
    					<input type="text" name="sc_name" v-model="sc.sc_name" />
    					<input type="text" name="sc_comment" v-model="sc.sc_comment" />
    					<input disabled type="created_at" v-model="sc.created_at" />
    					<input disabled type="updated_at" v-model="sc.updated_at" />
    					<button onclick="this.form._method.value='PUT'">modify</button>
    					<button onclick="this.form._method.value='DELETE'">delete</button>
    <br></br>
    				</form>
    			</li>
    		</ul>	
    	</div>
    	<script>
    	window.Laravel = {!! json_encode([
    	Â 'csrfToken' => csrf_token(),
    	]) !!};
    Â  Â  Â  Â  // vue.jsì˜ appì„ ìƒì„±
    	var sc_app = new Vue({
    		el: '#sc_app',
    		data: {
    			res:{'result':null,message:'','count':0,'simpleComments':[]},
    		}
    	})
    	$(function(){
    		ajax_action.lists();
    	})
    	var ajax_action = {
    		"lists":function(){
    			var url = "{{ route('simpleComment.index') }}";
    			$.ajax({
    				url: url,
    				type: 'GET', //GET
    				dataType: 'json', //xml, json, script, jsonp, or html
    				// data: post_data,
    			})
    			.done(function(rData) { //í†µì‹  ì„±ê³µ ì‹œ í˜¸ì¶œ
    				console.log("success");
    				if(!rData.result){
    					alert(rData.message)
    				}else{
    					sc_app.res = rData;
    				}
    			})
    			.fail(function() { //í†µì‹  ì‹¤íŒ¨ ì‹œ í˜¸ì¶œ
    				console.log("error");
    			})
    			.always(function() { //ì„±ê³µ/ì‹¤íŒ¨ í›„ í˜¸ì¶œ.
    				console.log("complete");
    			});
    		},
    		"action":function(f){
    			var url = f.action.replace(":sc_id",f.sc_id.value);
    			var post_data = $(f).serialize();
    			$.ajax({
    				url: url,
    				type: f._method.value, //GET
    				dataType: 'json', //xml, json, script, jsonp, or html
    				data: post_data,
    			})
    			.done(function(rData) { //í†µì‹  ì„±ê³µ ì‹œ í˜¸ì¶œ
    				console.log("success");
    				if(!rData.result){
    					alert(rData.message)
    				}else{
    					sc_app.res = rData;
    				}
    			})
    			.fail(function(e) { //í†µì‹  ì‹¤íŒ¨ ì‹œ í˜¸ì¶œ
    				console.log(e);
    			})
    			.always(function() { //ì„±ê³µ/ì‹¤íŒ¨ í›„ í˜¸ì¶œ.
    				console.log("complete");
    			});
    			f._method.value = '';
    		}
    	}
    	</script>
    <br></br>
    	<code style="white-space:pre">
    	API LISTS
    	+--------+-----------+------------------+------------+------------------------------------------------------+------------+
    	| Domain | MethodÂ  Â  | URIÂ  Â  Â  Â  Â  Â  Â  | NameÂ  Â  Â  Â | ActionÂ  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â  Â | Middleware |
    	+--------+-----------+------------------+------------+------------------------------------------------------+------------+
    	|Â  Â  Â  Â  | GET|HEADÂ  | api/scÂ  Â  Â  Â  Â  Â | sc.indexÂ  Â | App\Http\Controllers\SimpleCommentController@indexÂ  Â | apiÂ  Â  Â  Â  |
    	|Â  Â  Â  Â  | POSTÂ  Â  Â  | api/scÂ  Â  Â  Â  Â  Â | sc.storeÂ  Â | App\Http\Controllers\SimpleCommentController@storeÂ  Â | apiÂ  Â  Â  Â  |
    	|Â  Â  Â  Â  | GET|HEADÂ  | api/sc/createÂ  Â  | sc.createÂ  | App\Http\Controllers\SimpleCommentController@createÂ  | apiÂ  Â  Â  Â  |
    	|Â  Â  Â  Â  | GET|HEADÂ  | api/sc/{sc}Â  Â  Â  | sc.showÂ  Â  | App\Http\Controllers\SimpleCommentController@showÂ  Â  | apiÂ  Â  Â  Â  |
    	|Â  Â  Â  Â  | PUT|PATCH | api/sc/{sc}Â  Â  Â  | sc.updateÂ  | App\Http\Controllers\SimpleCommentController@updateÂ  | apiÂ  Â  Â  Â  |
    	|Â  Â  Â  Â  | DELETEÂ  Â  | api/sc/{sc}Â  Â  Â  | sc.destroy | App\Http\Controllers\SimpleCommentController@destroy | apiÂ  Â  Â  Â  |
    	|Â  Â  Â  Â  | GET|HEADÂ  | api/sc/{sc}/edit | sc.editÂ  Â  | App\Http\Controllers\SimpleCommentController@editÂ  Â  | apiÂ  Â  Â  Â  |
    	+--------+-----------+------------------+------------+------------------------------------------------------+------------+
    	</code>
    @endsection
    <br></br>




***
[ğŸ”—original-link](http://www.mins01.com/mh/tech/read/1245)