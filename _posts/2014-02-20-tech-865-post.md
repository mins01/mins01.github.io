---
title: "htmlí˜•ì‹ì˜ ì—‘ì…€ ë‹¤ìš´ë¡œë“œë¥¼ ë§Œë“¤ê²½ìš°."
date: 2014-02-20 14:03:41 +0900
categories: [php]
---

PHP ì›¹ ì‚¬ì´íŠ¸ì—ì„œÂ í˜„ì¬ ë³´ì´ëŠ” í˜ì´ì§€ë¥¼ ì—‘ì…€ë¡œ ë‹¤ìš´ ë°›ê²Œ í•´ë‹¬ë¼ëŠ” ìš”ì²­ì„ ë°›ëŠ” ê²½ìš°ê°€ ê½¤ ìˆëŠ”ë°...ê·¸ ì›¹ í˜ì´ì§€ ì•ˆì• ì„œ DBì ‘ì†í•˜ê³  ì¿¼ë¦¬ ë‚ ë¦¬ëŠ” ë¹„ì§€ë‹ˆìŠ¤ ë¶€ë¶„ê¹Œì§€ ë‹¤ ìˆë‹¤ë©´...  
&lt;div&gt;ì†ŒìŠ¤ ë³µì‚¬í•´ì„œ down_excel.php ë§Œë“¤ì§€ ë§ë¼. ë³‘ì‹ ê°™ì€ ì§“ì´ë‹¤.&lt;/div&gt;ì¿¼ë¦¬ ë°”ë€” ë•Œë§ˆë‹¤ down_excel.php ë„ ê°™ì´ ë°”ê¿”ì¤˜ì•¼í•˜ëŠ” 2ì¤‘ ì‘ì—…ì´ ìƒê¸´ë‹¤.  
  
ëŒ€ì‹  ë³¸ í˜ì´ì§€ ë¶€ë¶„ì˜ ë‚´ìš©ì„ ë²„í¼ ìºì‹œë¥¼ ì‚¬ìš©í•´ì„œ ë‚´ìš©ì„ ì˜ë¼ì„œ ë¶™ì—¬ ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ í•´ì„œì¦‰, í˜„ì¬ ë³´ì´ëŠ” í˜ì´ì§€ë¥¼ í›„ì²˜ë¦¬ë¡œ ë‹¤ìš´ë¡œë“œí•˜ê²Œ.  
#ì°¸ê³ ë¡œ ì´ê±´ htmlì„ í™•ì¥ìë§Œ xlsë¡œ ë°›ì„ ê²½ìš° í¸í•˜ê²Œ í•˜ê¸°ìœ„í•œ ë°©ë²•ì´ë‹¤.(excel writer ê°™ì€ê±¸ ì“´ë‹¤ë©´ ì´ë¯¸ DBê´€ë ¨ ë¶€ë¶„ì´ ë”°ë¡œ ë¹ ì ¸ìˆê² ì§€....)  
- - - - - -

#ê¸°ë³¸ ì†ŒìŠ¤ (down_excel.php)  
&lt;div&gt;&amp;amp;lt;?&lt;/div&gt;&lt;div&gt;ob_start();&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;header( "Content-type: application/vnd.ms-excel" );&lt;/div&gt;&lt;div&gt;header( "Content-Disposition: attachment; filename={{ë‹¤ìš´ë¡œë“œ ë°›ì„ íŒŒì¼ëª…}}.xls" );&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;require({{ì›¹ì—ì„œë³´ì—¬ì§€ëŠ” PHPíŒŒì¼}});&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;$cont = ob_get_contents();&lt;/div&gt;&lt;div&gt;ob_end_clean();&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;  &amp;#xD;
&lt;/div&gt;&lt;div&gt;$cont = substr($cont,strpos($cont,'&amp;amp;lt;!-- CONTENT TABLE --&amp;amp;gt;')); //ì£¼ì„ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜ë¼ì˜¨ë‹¤.&lt;/div&gt;&lt;div&gt;$cont = substr($cont,0,strpos($cont,'&amp;amp;lt;!-- //CONTENT TABLE --&amp;amp;gt;')+strlen('&amp;amp;lt;!-- //CONTENT TABLE --&amp;amp;gt;'));//ì£¼ì„ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜ë¼ì˜¨ë‹¤.&lt;/div&gt;&lt;div&gt;$cont = preg_replace('/&amp;amp;lt;input[^&amp;amp;gt;]*&amp;amp;gt;/i','',$cont); //input íƒœê·¸ ì‚­ì œ.&lt;/div&gt;&lt;div&gt;echo $cont;&lt;/div&gt;&lt;div&gt;exit('&amp;amp;lt;!-- END --&amp;amp;gt;');&lt;/div&gt;&lt;div&gt;?&amp;amp;gt;&lt;/div&gt;  
- - - - - -

# ì›¹ì—ì„œë³´ì—¬ì§€ëŠ” PHPíŒŒì¼ (view.php)  
{{ìƒëµ}}&amp;lt;!-- CONTENT TABLE --&amp;gt;&amp;lt;table&amp;gt;&lt;span class="Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&amp;lt;tr&amp;gt;&lt;span class="Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&amp;lt;td&amp;gt;....&amp;lt;/td&amp;gt;&lt;span class="Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&amp;lt;/tr&amp;gt;&lt;span class="Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;{{ìƒëµ}}&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;&amp;amp;lt;tr&amp;amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;&amp;amp;lt;td&amp;amp;gt;....&amp;amp;lt;/td&amp;amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;gt;&amp;lt;/span&amp;gt;&amp;amp;lt;/tr&amp;amp;gt;&lt;/div&gt;&amp;lt;/table&amp;gt;&amp;lt;!-- //CONTENT TABLE --&amp;gt;{{ìƒëµ}}  
- - - - - -

  
view.phpë¥¼ getìœ¼ë¡œ ë¶ˆë ¸ë‹¤ë©´ ë˜‘ê°™ì€ ê°’(queryString)ìœ¼ë¡œ down_excel.php ë¥¼ getìœ¼ë¡œ ë¶ˆëŸ¬ë¼postë¼ë©´ ë˜‘ê°™ì€ postê°’ìœ¼ë¡œ ...Â   
ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ìœ¼ë¡œ ë°‘ì˜ ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸¸ ì¶”ì²œ.Â &lt;div&gt;&amp;amp;lt;form action="down_excel.php"&amp;amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;&amp;amp;lt;input type="submit" value="EXCEL ì €ì¥"&amp;amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;&amp;amp;lt;? foreach($_POST as $k=&amp;amp;gt;$v){ ?&amp;amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;&amp;amp;lt;input type="hidden" name="&amp;amp;lt;?=htmlspecialchars($k)?&amp;amp;gt;" Â value="&amp;amp;lt;?=htmlspecialchars($v)?&amp;amp;gt;" &amp;amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;&amp;amp;lt;? } ?&amp;amp;gt;&lt;/div&gt;&amp;lt;/form&amp;gt;  
- - - - - -

ì¶œë ¥ë²„í¼ ì†ì˜ ë‚´ìš©ì´ ì»¤ì§ˆ ê²½ìš° ë©”ëª¨ë¦¬ ì œí•œì„ ëŠ˜ë ¤ë³´ì„¸ìš”.


[ğŸ”—link](http://www.mins01.com/mh/tech/read/865)