---
title: "htmlí˜•ì‹ì˜ ì—‘ì…€ ë‹¤ìš´ë¡œë“œë¥¼ ë§Œë“¤ê²½ìš°."
date: 2014-02-20 14:03:41 +0900
categories: [php]
---

PHP ì›¹ ì‚¬ì´íŠ¸ì—ì„œÂ í˜„ì¬ ë³´ì´ëŠ” í˜ì´ì§€ë¥¼ ì—‘ì…€ë¡œ ë‹¤ìš´ ë°›ê²Œ í•´ë‹¬ë¼ëŠ” ìš”ì²­ì„ ë°›ëŠ” ê²½ìš°ê°€ ê½¤ ìˆëŠ”ë°...ê·¸ ì›¹ í˜ì´ì§€ ì•ˆì• ì„œ DBì ‘ì†í•˜ê³  ì¿¼ë¦¬ ë‚ ë¦¬ëŠ” ë¹„ì§€ë‹ˆìŠ¤ ë¶€ë¶„ê¹Œì§€ ë‹¤ ìˆë‹¤ë©´...  
ì†ŒìŠ¤ ë³µì‚¬í•´ì„œ down_excel.php ë§Œë“¤ì§€ ë§ë¼. ë³‘ì‹ ê°™ì€ ì§“ì´ë‹¤.ì¿¼ë¦¬ ë°”ë€” ë•Œë§ˆë‹¤ down_excel.php ë„ ê°™ì´ ë°”ê¿”ì¤˜ì•¼í•˜ëŠ” 2ì¤‘ ì‘ì—…ì´ ìƒê¸´ë‹¤.  
  
ëŒ€ì‹  ë³¸ í˜ì´ì§€ ë¶€ë¶„ì˜ ë‚´ìš©ì„ ë²„í¼ ìºì‹œë¥¼ ì‚¬ìš©í•´ì„œ ë‚´ìš©ì„ ì˜ë¼ì„œ ë¶™ì—¬ ì£¼ëŠ” ë°©ì‹ìœ¼ë¡œ í•´ì„œì¦‰, í˜„ì¬ ë³´ì´ëŠ” í˜ì´ì§€ë¥¼ í›„ì²˜ë¦¬ë¡œ ë‹¤ìš´ë¡œë“œí•˜ê²Œ.  
#ì°¸ê³ ë¡œ ì´ê±´ htmlì„ í™•ì¥ìë§Œ xlsë¡œ ë°›ì„ ê²½ìš° í¸í•˜ê²Œ í•˜ê¸°ìœ„í•œ ë°©ë²•ì´ë‹¤.(excel writer ê°™ì€ê±¸ ì“´ë‹¤ë©´ ì´ë¯¸ DBê´€ë ¨ ë¶€ë¶„ì´ ë”°ë¡œ ë¹ ì ¸ìˆê² ì§€....)  
- - - - - -

#ê¸°ë³¸ ì†ŒìŠ¤ (down_excel.php)  
ob_start();  &#xD;
header( "Content-type: application/vnd.ms-excel" );header( "Content-Disposition: attachment; filename={{ë‹¤ìš´ë¡œë“œ ë°›ì„ íŒŒì¼ëª…}}.xls" );  &#xD;
require({{ì›¹ì—ì„œë³´ì—¬ì§€ëŠ” PHPíŒŒì¼}});  &#xD;
$cont = ob_get_contents();ob_end_clean();  &#xD;
  &#xD;
$cont = substr($cont,strpos($cont,'')); //ì£¼ì„ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜ë¼ì˜¨ë‹¤.$cont = substr($cont,0,strpos($cont,'')+strlen(''));//ì£¼ì„ì„ ê¸°ì¤€ìœ¼ë¡œ ì˜ë¼ì˜¨ë‹¤.$cont = preg_replace('/&lt;input&gt;&lt;/input&gt;]*&amp;gt;/i','',$cont); //input íƒœê·¸ ì‚­ì œ.echo $cont;exit('');?&amp;gt;  
- - - - - -

# ì›¹ì—ì„œë³´ì—¬ì§€ëŠ” PHPíŒŒì¼ (view.php)  
{{ìƒëµ}}<table>&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;&amp;lt;tr&amp;gt;&amp;amp;lt;div&amp;amp;gt;&amp;amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;amp;gt;&amp;amp;amp;lt;/span&amp;amp;amp;gt;&amp;amp;amp;lt;td&amp;amp;amp;gt;....&amp;amp;amp;lt;/td&amp;amp;amp;gt;&amp;amp;lt;/div&amp;amp;gt;&amp;amp;lt;div&amp;amp;gt;&amp;amp;amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;amp;amp;gt;&amp;amp;amp;lt;/span&amp;amp;amp;gt;&amp;amp;lt;/div&amp;amp;gt;&amp;lt;/tr&amp;gt;&lt;/div&gt;&lt;div&gt;&amp;lt;span class="Apple-tab-span" style="white-space:pre"&amp;gt;&amp;lt;/span&amp;gt;{{ìƒëµ}}&lt;/div&gt;&lt;div&gt;&amp;lt;div&amp;gt;&amp;amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;amp;gt;&amp;amp;lt;/span&amp;amp;gt;&amp;amp;lt;tr&amp;amp;gt;&amp;amp;amp;lt;div&amp;amp;amp;gt;&amp;amp;amp;amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;amp;amp;amp;gt;&amp;amp;amp;amp;lt;/span&amp;amp;amp;amp;gt;&amp;amp;amp;amp;lt;td&amp;amp;amp;amp;gt;....&amp;amp;amp;amp;lt;/td&amp;amp;amp;amp;gt;&amp;amp;amp;lt;/div&amp;amp;amp;gt;&amp;amp;amp;lt;div&amp;amp;amp;gt;&amp;amp;amp;amp;lt;span class="Apple-tab-span" style="white-space: pre;"&amp;amp;amp;amp;gt;&amp;amp;amp;amp;lt;/span&amp;amp;amp;amp;gt;&amp;amp;amp;lt;/div&amp;amp;amp;gt;&amp;amp;lt;/tr&amp;amp;gt;&amp;lt;/div&amp;gt;&lt;/div&gt;&lt;div&gt;&lt;/div&gt;</table>{{ìƒëµ}}  
- - - - - -

  
view.phpë¥¼ getìœ¼ë¡œ ë¶ˆë ¸ë‹¤ë©´ ë˜‘ê°™ì€ ê°’(queryString)ìœ¼ë¡œ down_excel.php ë¥¼ getìœ¼ë¡œ ë¶ˆëŸ¬ë¼postë¼ë©´ ë˜‘ê°™ì€ postê°’ìœ¼ë¡œ ...Â   
ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ìœ¼ë¡œ ë°‘ì˜ ì†ŒìŠ¤ë¥¼ ì‚¬ìš©í•˜ê¸¸ ì¶”ì²œ.Â &lt;form action="down_excel.php"&gt;&lt;/form&gt;&lt;span class="Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&lt;input type="submit" value="EXCEL ì €ì¥"&gt;&lt;/input&gt;&lt;span class="Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt; foreach($_POST as $k=&amp;gt;$v){ ?&amp;gt;&lt;span class="Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt;&lt;input name="&amp;lt;?=htmlspecialchars($k)?&gt;" type="hidden"&gt;&lt;/input&gt;" &amp;gt;&lt;span class="Apple-tab-span" style="white-space:pre"&gt;&lt;/span&gt; } ?&amp;gt;  
- - - - - -

ì¶œë ¥ë²„í¼ ì†ì˜ ë‚´ìš©ì´ ì»¤ì§ˆ ê²½ìš° ë©”ëª¨ë¦¬ ì œí•œì„ ëŠ˜ë ¤ë³´ì„¸ìš”.


[ğŸ”—link](http://www.mins01.com/mh/tech/read/865)